- name: Include OS-specific variables.
  include_vars: "{{ ansible_os_family }}.yml"

# <2017-01-16 mÃ¥n> Installing 'docker-engine' instead of the default
# 'docker'. The reason is that 'docker' didn't work properly out of the box -
# the client couldn't reach the daemon due to (I think) a socket mishap.
- name: Add the official docker repository
  yum_repository:
    name: docker
    description: Offical Docker RPM repository
    enabled: yes
    baseurl: https://yum.dockerproject.org/repo/main/centos/7/
    gpgcheck: yes
    gpgkey: https://yum.dockerproject.org/gpg
  when: ansible_distribution == 'CentOS'

- name: Install docker
  package:
    name={{docker_package_name}} state=present
- name: Start docker
  service: name=docker state=started enabled=yes

# Required to be present for ansible's docker module to work properly.
- name: Install docker python bindings
  package: name="{{ docker_python_package_name }}" state=present

- name: Install docker-compose
  package: name=docker-compose state=present